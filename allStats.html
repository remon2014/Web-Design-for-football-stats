<?php
  include 'FootballData.php';
  date_default_timezone_set("Europe/London");
?>
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>All Statistics</title>
  <link href="/css/bootstrap.min.css" type="text/css" rel="stylesheet" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <style>
  /* Remove the navbar's default margin-bottom and rounded borders */
  .navbar {
    margin-bottom: 0;
    border-radius: 0;
  }

  /* Style to reverse the caret icon from pointing downwards to upwards */
  .caret.caret-up {
    border-top-width: 0;
    border-bottom: 4px solid #fff;
  }
  /* Set height of the grid so .sidenav can be 100% (adjust as needed) */
  .row.content {height: 450px}

  /* Set gray background color and 100% height */
  .sidenav {
    padding-top: 20px;
    background-color: #f1f1f1;
    height: 100%;
  }

  /* Set black background color, white text and some padding */
  footer {
    background-color: #555;
    color: white;
    padding: 15px;
  }

  /* On small screens, set height to 'auto' for sidenav and grid */
  @media screen and (max-width: 767px) {
    .sidenav {
      height: auto;
      padding: 15px;
    }
    .row.content {height:auto;}
  }
</style>
</head>
<body>
  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="/index.html">FootyStats</a>
      </div
      <div class="collapse navbar-collapse" id="myNavbar">
        <ul class="nav navbar-nav">
          <li><a href="index.html">Home</a></li>
          <li><a href="/fixtures.html">Fixtures</a></li>
          <li><a href="/results.html">Results</a></li>
          <li><a href="/teams.html">Teams</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
              <li class="active"><a href="/allStats.html">All Statistics</a></li>
            </ul>
          </div>
        </div>
      </nav>
      <script type="text/javascript">
            $.ajax({
              headers: { 'X-Auth-Token': '532d544a2b70445e9b818d6852a73979' },
              url: 'http://api.football-data.org/v1/competitions/445/teams',
              dataType: 'json',
              type: 'GET',
          }).done(function(response) {
              var dropdown = document.getElementById("dropdownMenu");
              
              // do something with the response, e.g. isolate the id of a linked resource        
              // var regex = /.*?(\d+)$/; // the ? makes the first part non-greedy
              // var res = regex.exec(response.fixtures[0]._links.awayTeam.href);
              // var teamId = res[1];
              console.log(response.teams);
              teams = response.teams;
              for (x = 0; x < teams.length; x++)
              {
                teamlink = teams[x]._links.self['href'];
                teamid = teamlink.replace("http://api.football-data.org/v1/teams/","");
                var entry = document.createElement('li');
                // entry.appendChild(document.createTextNode(teams[x].name));
                var link = document.createElement('a');
                link.setAttribute('href','?='+teamid);
                link.appendChild(document.createTextNode(teams[x].name));
                entry.appendChild(link);
                dropdown.appendChild(entry);
                
              }
              console.log(window.location.href);
              teamID = window.location.href.replace("http://www.footystats.com/allStats.html?=","");
              console.log(teamID);
              teamFixtureURL = "http://api.football-data.org/v1/teams/" + teamID + "/fixtures";
              console.log(teamFixtureURL);

          }); 
          </script>

        <!--<?php
          $uri = 'http://api.football-data.org/v1/competitions/354/fixtures/?matchday=22';
          $reqPrefs['http']['method'] = 'GET';
          $reqPrefs['http']['header'] = 'X-Auth-Token: YOUR_API_TOKEN';
          $stream_context = stream_context_create($reqPrefs);
          $response = file_get_contents($uri, false, $stream_context);
          $fixtures = json_decode($response);
      ?>-->
        <div class="container">
                <div class="page-header">
                    <h1>All Statistics</h1>
                    <div class="container">                                      
                      <div class="dropdown">
                        <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Dropdown
                        <span class="caret"></span></button>
                        <ul class="dropdown-menu" id="dropdownMenu">
                        </ul>
                    </div>

              </div>
      <footer class="container-fluid text-center">
        <p>Footer Text</p>
      </footer>
    </body>
</html>
